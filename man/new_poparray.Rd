% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/poparray_class.r
\name{new_poparray}
\alias{new_poparray}
\title{Construct a poparray}
\usage{
new_poparray(
  x,
  dimnames_list = dimnames(x),
  data_col = "population",
  source = NULL,
  time_dim = "year",
  area_dim = "area.name",
  ...
)
}
\arguments{
\item{x}{A \code{DelayedArray}-compatible object (e.g., \code{HDF5Array}, \code{DelayedArray}, or an in-memory array/matrix that can
be wrapped).}

\item{dimnames_list}{Named list of dimension labels. Must have the same number of elements as \code{dim(x)}, and each
element length must match the corresponding dimension extent. Dimension labels must be unique within each
dimension.}

\item{data_col}{Single character string giving the value-column name to use when coercing to tabular formats (e.g.,
via \code{as.data.frame()}/\code{as_tibble()} methods).}

\item{source}{Optional metadata describing the data source/provenance (character or list).}

\item{time_dim}{Single character string naming the time dimension. Defaults to \code{"year"}. If not \code{"year"}, it must be
supplied explicitly and must exist in \code{names(dimnames_list)}. The labels for this dimension must be ordered.}

\item{area_dim}{Single character string naming the area dimension. Defaults to \code{"area.name"}. Must exist in
\code{names(dimnames_list)}.}

\item{...}{Reserved for future use.}
}
\value{
An S3 object of class \code{"poparray"}.
}
\description{
Creates a poparray object: a lazy, role-aware population cube backed by a \code{DelayedArray} (often an \code{HDF5Array}) with
explicit dimension labels.  Dimensions representing time and area are required (invariants).
}
\details{
A poparray must include exactly one time dimension and one area dimension (by default \code{"year"} and \code{"area.name"}),
and all other dimensions are treated as optional stratification dimensions.

The constructor is lazy-first: it wraps non-delayed inputs in \code{DelayedArray::DelayedArray()} and does not realize the
full array in memory.

The resulting object stores:
\itemize{
\item \code{handle}: the delayed backend (numeric array-like data),
\item \code{dimn}: the explicit dimnames list,
\item attributes including \code{dimroles} (a named list with \code{time}, \code{area}, and
\code{strata}) and \code{data_col}.
}
}
\examples{
\dontrun{
library(DelayedArray)

arr <- array(1:12, dim = c(3, 4))
dimnames(arr) <- list(
  year = c("2020", "2021", "2022"),
  area.name = paste0("A", 1:4)
)

pa <- new_poparray(arr)
pa

# Non-default roles (must be explicit and ordered)
dimnames(arr) <- list(
  time = c("2020", "2021", "2022"),
  area.name = paste0("A", 1:4)
)
pa2 <- new_poparray(arr, time_dim = "time", area_dim = "area.name")
}

}
