% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/projection_plot.r
\name{plot.tarr_projection}
\alias{plot.tarr_projection}
\title{Plot a population projection}
\usage{
\method{plot}{tarr_projection}(
  x,
  type = c("ts", "pyramid"),
  areas = NULL,
  max_areas = 3,
  max_years = 5,
  ...
)
}
\arguments{
\item{x}{A \code{tarr_projection} object.}

\item{type}{Plot type: \code{"ts"} for a time-series plot of total population
or \code{"pyramid"} for a grid of population pyramids.}

\item{areas}{Optional character vector of area names to plot when
\code{type = "pyramid"}. If \code{NULL}, the first \code{max_areas} areas are used.}

\item{max_areas}{Maximum number of areas to display when \code{areas} is \code{NULL}.
Defaults to 3 and may not exceed 7.}

\item{max_years}{Maximum number of years to display for population pyramids.
Defaults to 5 and may not exceed 5. The most recent years are used.}

\item{...}{Additional graphical parameters passed to the plotting functions.}
}
\value{
Invisibly returns the input \code{tarr_projection} object.
}
\description{
Visualizes a \code{tarr_projection} object either as a time series of total
population with uncertainty bounds or as a grid of population pyramids.
}
\details{
\subsection{Plot types}{
\itemize{
\item \strong{\code{"ts"} (default)} — Plots the total projected population for each
time period as a line, aggregated across all non-time dimensions.
Uncertainty is shown as a shaded ribbon between the \code{lower} and \code{upper}
projection bounds. This plot always uses all three projection cubes and
ignores area-specific arguments.
\item \strong{\code{"pyramid"}} — Displays population pyramids based on the
\code{projected} cube only. Pyramids are arranged in a grid with
\strong{years in rows} and \strong{areas in columns}.
}
}

\subsection{Area and year selection for population pyramids}{

For \code{type = "pyramid"}:
\itemize{
\item Up to \code{max_years} (default 5) of the \strong{most recent years} are shown.
This reflects the assumption that forecast accuracy decreases as
projections extend further from the final base year.
\item Up to \code{max_areas} (default 3, maximum 7) areas are shown.
If \code{areas} is \code{NULL}, the first areas appearing in the cube are used.
\item If \code{areas} is supplied, it must be a character vector of area names
present in the cube; otherwise an error is thrown.
\item If the total number of panels (years × areas) exceeds 16, a warning is
issued because interpretation may become difficult.
}

Population pyramid plots require the presence of \code{sex} and \code{age.char}
dimensions in the underlying cube.
}

\subsection{Additional graphical parameters}{

Additional arguments supplied via \code{...} are forwarded to the underlying
plotting functions.

For \code{type = "ts"}, the following optional parameters are recognized:
\itemize{
\item \code{ribbon_col} — Fill color for the uncertainty ribbon
(default: semi-transparent gray).
\item \code{ribbon_border} — Border color for the ribbon (default: \code{NA}).
}

Other graphical parameters (e.g., \code{lwd}, \code{col}, \code{cex}) are passed to the
base plotting functions.
}
}
\examples{
# Create a small synthetic projection example
dn <- list(
  year = as.character(2016:2022),   # 7 years -> "auto" selects ETS
  area.name = c("Area A", "Area B"),
  sex = c("female", "male"),
  age.char = c("0-4", "5-9", "10-14")
)

arr <- array(
  sample(100:500, prod(lengths(dn)), replace = TRUE),
  dim = lengths(dn),
  dimnames = dn
)

tp <- new_tarr_pop(
  x = DelayedArray::DelayedArray(arr),
  dimnames_list = dn,
  data_col = "population",
  source = "example"
)

\dontrun{
  pr <- project(tp, h = 3, method = "auto")

  # Time series of total population with uncertainty ribbon
  plot(pr, type = "ts", lwd = 2)

  # Population pyramids for selected areas
  plot(pr, type = "pyramid", areas = "Area A")
}

}
\seealso{
\itemize{
\item \code{\link[=project]{project()}} for creating population projections
\item \link{tarr_projection} for the projection object structure
\item \code{\link[=plot.tarr_pop]{plot.tarr_pop()}} for population pyramid plotting
\item \code{\link[=as.tarr_pop.tarr_projection]{as.tarr_pop.tarr_projection()}} to extract individual projection cubes
}
}
